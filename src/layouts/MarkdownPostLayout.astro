---
import type { MarkdownLayoutProps } from 'astro';
import type { PostFrontmatter } from '../types/Post';
import PostMetadata from '../components/PostMetadata.astro';
import ProseArticleLayout from './ProseArticleLayout.astro';
import TableOfContents from '../components/TableOfContents.astro';

type Props = MarkdownLayoutProps<PostFrontmatter>;

const { frontmatter, headings } = Astro.props;
const tocHeadings = headings.filter(({ depth }) => depth === 2 || depth === 3);
---

<ProseArticleLayout
  pageTitle={frontmatter.title}
  ogimage={frontmatter.ogimage && frontmatter.ogimage.src}
  description={frontmatter.description}
  tocHeadings={tocHeadings}
>
  <PostMetadata
    tags={frontmatter.tags}
    pubDate={frontmatter.pubDate}
    updatedDate={frontmatter.updatedDate}
  />
  <h1>
    {frontmatter.title}
  </h1>
  {
    frontmatter.image && (
      <img
        class="rounded"
        src={frontmatter.image.src}
        alt={frontmatter.image.alt}
      />
    )
  }
  {
    frontmatter.description && (
      <p class="rounded bg-neutral-100 px-4 py-3 text-left dark:bg-neutral-800">
        {frontmatter.description}
      </p>
    )
  }
  {
    tocHeadings.length > 0 && (
      <TableOfContents headings={tocHeadings} class="block xl:hidden" />
    )
  }
  <slot />
</ProseArticleLayout>
